<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Page and Multi-Figure Examples • gridify</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multi-Page and Multi-Figure Examples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gridify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/gridify.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple_examples.html">Simple Examples</a>
    </li>
    <li>
      <a href="../articles/multi_page_examples.html">Multi-Page and Multi-Figure Examples</a>
    </li>
    <li>
      <a href="../articles/create_custom_layout.html">Create Custom Layout</a>
    </li>
    <li>
      <a href="../articles/transparency.html">Transparency with gridify</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multi-Page and Multi-Figure Examples</h1>
            
      

      <div class="hidden name"><code>multi_page_examples.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document discusses advanced uses of <code>gridify</code>, to
automate the generation of multiple figures or tables. It is recommended
that you start with
<code><a href="../articles/gridify.html">vignette("gridify", package = "gridify")</a></code> and
<code><a href="../articles/simple_examples.html">vignette("simple_examples", package = "gridify")</a></code>, before
continuing with this vignette.</p>
<p>The <code>magrittr</code> and <code>ggplot2</code> packages will be
useful for the examples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridify</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h3>
<p>In this section, we will be discussing a method to automate the
generation of multiple figures for data visualization. The code provided
below is written in R and uses the <code>ggplot2</code> and
<code>gridify</code> libraries.</p>
<p>The process involves:</p>
<ul>
<li>Defining the necessary data</li>
<li>Creating a function to generate each figure</li>
<li>Using loops to create and save each output, with
<code><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf()</a></code> to template text elements</li>
</ul>
<p>This strategy is particularly useful when you have a large number of
figures to generate that share common text elements.</p>
<div class="section level4">
<h4 id="multiple-figure-delivery-with-a-for-loop-and-sprintf">Multiple Figure Delivery with a for-loop and sprintf<a class="anchor" aria-label="anchor" href="#multiple-figure-delivery-with-a-for-loop-and-sprintf"></a>
</h4>
<p>When creating multiple figures at once, it can be useful to have some
metadata relating to your cell text in a list to help automate the
process of adding titles, footers, etc. This could be via a dataset
created in your code, or a separate file that is read in, e.g. an excel
file.</p>
<p>In the example below, we have created some dummy metadata based on
the <code>mtcars</code> dataset. The elements in <code>global</code>
apply to all figures, the others are figure specific so have been listed
individually.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figures_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  global <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    project <span class="op">=</span> <span class="st">"My Project"</span>,</span>
<span>    indication <span class="op">=</span> <span class="st">"My Indication"</span>,</span>
<span>    study <span class="op">=</span> <span class="st">"My Study"</span>,</span>
<span>    cutoff <span class="op">=</span> <span class="st">"Data Cut-off: YYYY-MM-DD"</span>,</span>
<span>    program <span class="op">=</span> <span class="st">"program1.R"</span>,</span>
<span>    var1 <span class="op">=</span> <span class="st">"mpg"</span>,</span>
<span>    note1 <span class="op">=</span> <span class="st">"Note: Violin figure: compact display of continuous distribution; it is a blend of boxplot and density,</span></span>
<span><span class="st">    the latter based on a Gaussian kernel estimator."</span>,</span>
<span>    note2 <span class="op">=</span> <span class="st">"Note: Placebo subjects switched to Study Drug at/after Week 16."</span>,</span>
<span>    note3 <span class="op">=</span> <span class="st">"Note: Total Study Drug includes subjects randomized to Placebo and to Study Drug."</span>,</span>
<span>    note4 <span class="op">=</span> <span class="st">"Note: N denotes the treatment population and n denotes the contributing population for</span></span>
<span><span class="st">    the analysis for each treatment, parameter and visit"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  figures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    figure1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      number <span class="op">=</span> <span class="st">"1.1"</span>,</span>
<span>      title1 <span class="op">=</span> <span class="st">"My title Group A"</span>,</span>
<span>      title2 <span class="op">=</span> <span class="st">"My title 2"</span>,</span>
<span>      var2 <span class="op">=</span> <span class="st">"wt"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    figure2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      number <span class="op">=</span> <span class="st">"1.2"</span>,</span>
<span>      title1 <span class="op">=</span> <span class="st">"My Title Group B"</span>,</span>
<span>      title2 <span class="op">=</span> <span class="st">"My title 2"</span>,</span>
<span>      var2 <span class="op">=</span> <span class="st">"cyl"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you already have a dataset, such as an excel file, then you can
process this file to get a proper list. You should add additional
columns to the file to help build each figure.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_excel</span><span class="op">(</span><span class="st">"PATH TO YOUR FILE"</span><span class="op">)</span></span>
<span><span class="va">figures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="va">dat</span><span class="op">[</span><span class="va">row</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Optionally, you can add names to the elements of 'figures' so you won't have to subset by index later</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">figures</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"figure"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">figures</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Alternatively, you can leave the 'dat' object as it is and loop through its rows,</span></span>
<span><span class="co"># or with row names if available</span></span></code></pre></div>
<p>It would be helpful to create a figure-generating function with
arguments that affect the elements of the output, an example of this
could be:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generate_figure</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">var1</span>, <span class="va">var2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/name.html" class="external-link">as.name</a></span><span class="op">(</span><span class="va">var1</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/name.html" class="external-link">as.name</a></span><span class="op">(</span><span class="va">var2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>You want to collect all figures in a separate list. Here, the
variable <code>figures_list</code> is a container for our outputs.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figures_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Optionally, set global variables, which are usually defined at the
top of a script.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">COMPANY</span> <span class="op">&lt;-</span> <span class="st">"My Company"</span></span>
<span><span class="va">STATUS</span> <span class="op">&lt;-</span> <span class="st">"DRAFT"</span></span></code></pre></div>
<p>Now you can run a for-loop to generate many <code>gridify</code>
objects.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">figure_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">figure_obj</span> <span class="op">&lt;-</span> <span class="fu">generate_figure</span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">var1</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">[[</span><span class="va">figure_index</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">var2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add text elements using `sprintf()`</span></span>
<span>  <span class="va">gridify_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridify.html">gridify</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">figure_obj</span>,</span>
<span>    layout <span class="op">=</span> <span class="fu"><a href="../reference/pharma_layout_A4.html">pharma_layout_A4</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Add STATIC text elements to the `gridify` object</span></span>
<span>    <span class="co"># You can define these values as variables at the top of your script</span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_1"</span>, <span class="va">COMPANY</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"watermark"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">STATUS</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_2"</span>, <span class="va">STATUS</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Add VARIABLE text elements to the gridify object</span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s / %s"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">project</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">indication</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_3"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"output_num"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Output %s"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">[[</span><span class="va">figure_index</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">number</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_1"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">[[</span><span class="va">figure_index</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">title1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_2"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">[[</span><span class="va">figure_index</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">title2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"note"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"note1"</span>, <span class="st">"note2"</span>, <span class="st">"note3"</span>, <span class="st">"note4"</span><span class="op">)</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_left"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Program: %s, %s"</span>, <span class="va">figures_data</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">program</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_right"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Page %s of %s"</span>, <span class="va">figure_index</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">figures_data</span><span class="op">$</span><span class="va">figures</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">figures_list</span><span class="op">[[</span><span class="va">figure_index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gridify_obj</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><code>.Rmd</code> and <code>.Qmd</code> documents should be
considered as alternatives for saving <code>gridify</code> objects,
which can be used directly in your Rmd and Qmd documents, similar to the
<code>gridify</code> package vignettes.</p>
<p>You can generate a PDF for each figure individually and then combine
them in software like Acrobat.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">figures_list</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"./figures/test_Company_A4_layout_%s.pdf"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">figures_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Or you can generate a single PDF file with all figures.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">figures_list</span>,</span>
<span>  <span class="st">"./figures/test_multi_Company_A4_layout.pdf"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<div class="section level4">
<h4 id="for-pdfdocx">For PDF/DOCX<a class="anchor" aria-label="anchor" href="#for-pdfdocx"></a>
</h4>
<p>Large tables can be difficult to display on a single page, with the
shrunken dimensions making them hard to read and interpret.
<code>gridify</code>, in combination with the <code>gt</code> package,
solves this by allowing you to split tables based on row limits, helping
maintain a professional format. Here is an example of this in practice
when creating outputs for pdf/docx files.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="splitting-by-rows-for-pdf-or-docx">Splitting By Rows for PDF or DOCX<a class="anchor" aria-label="anchor" href="#splitting-by-rows-for-pdf-or-docx"></a>
</h4>
<p>If you are dealing with an extensive table, displaying all the data
on a single page can make it difficult to read. This is where splitting
the table based on the number of rows is an effective solution. Let’s
see how this can be implemented.</p>
<p>First, we specify the different features we want the output to
have.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"vs"</span>, <span class="st">"am"</span>, <span class="st">"drat"</span>, <span class="st">"qsec"</span><span class="op">)</span> <span class="co"># Columns that appear in final output</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span>, <span class="va">table_cols</span><span class="op">]</span></span>
<span><span class="va">rows_per_page</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">row_height_pixels</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">font_size</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">font_type</span> <span class="op">&lt;-</span> <span class="st">"serif"</span></span>
<span></span>
<span><span class="va">number_of_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">number_of_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">number_of_pages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">number_of_rows</span> <span class="op">/</span> <span class="va">rows_per_page</span><span class="op">)</span></span></code></pre></div>
<p>Next, we divide the original data frame into smaller tables.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Allocate each row to a page</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">page_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="va">number_of_pages</span>,</span>
<span>  each <span class="op">=</span> <span class="va">rows_per_page</span>,</span>
<span>  length.out <span class="op">=</span> <span class="va">number_of_rows</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split original table into smaller pages</span></span>
<span><span class="va">pages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">page_number</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional---fill-last-table-with-empty-rows">OPTIONAL - Fill last table with empty rows<a class="anchor" aria-label="anchor" href="#optional---fill-last-table-with-empty-rows"></a>
</h4>
<p>If the last table doesn’t meet the <code>rows_per_page</code>
specification, it will appear as if it was placed in the middle of the
page. For it to be placed at the top, the following code will add empty
rows to the last table until there are <code>rows_per_page</code>
rows.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">last_page</span> <span class="op">&lt;-</span> <span class="va">pages</span><span class="op">[[</span><span class="va">number_of_pages</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">last_page_nrows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">last_page</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">last_page_nrows</span> <span class="op">&lt;</span> <span class="va">rows_per_page</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rows_difference</span> <span class="op">&lt;-</span> <span class="va">rows_per_page</span> <span class="op">-</span> <span class="va">last_page_nrows</span></span>
<span>  <span class="va">append_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">" "</span>, nrow <span class="op">=</span> <span class="va">rows_difference</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">append_table</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">pages</span><span class="op">[[</span><span class="va">number_of_pages</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">last_page</span>, <span class="va">append_table</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Finally, we generate each page of the output, by converting each
table into a <code>gtable</code> with the <code>gt</code> package then
looping over the <code>gridify</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pages</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gt_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">pages</span><span class="op">[[</span><span class="va">iter</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html" class="external-link">tab_options</a></span><span class="op">(</span></span>
<span>      table.width <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/pct.html" class="external-link">pct</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>      data_row.padding <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/px.html" class="external-link">px</a></span><span class="op">(</span><span class="va">row_height_pixels</span><span class="op">)</span>,</span>
<span>      table_body.hlines.color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>      page.numbering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      table.font.size <span class="op">=</span> <span class="va">font_size</span>,</span>
<span>      table.font.names <span class="op">=</span> <span class="va">font_type</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="va">iter</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridify.html">gridify</a></span><span class="op">(</span></span>
<span>    <span class="va">gt_input</span>,</span>
<span>    layout <span class="op">=</span> <span class="fu"><a href="../reference/pharma_layout_A4.html">pharma_layout_A4</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_1"</span>, <span class="st">"My Company"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_2"</span>, <span class="st">"&lt;PROJECT&gt; / &lt;INDICATION&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_3"</span>, <span class="st">"&lt;STUDY&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_1"</span>, <span class="st">"CONFIDENTIAL"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_2"</span>, <span class="st">"&lt;Draft or Final&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_3"</span>, <span class="st">"Data Cut-off: YYYY-MM-DD"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"output_num"</span>, <span class="st">"&lt;Output&gt; xx.xx.xx"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_1"</span>, <span class="st">"&lt;Title 1&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_2"</span>, <span class="st">"&lt;Title 2&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_3"</span>, <span class="st">"&lt;Optional Title 3&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"note"</span>, <span class="st">"&lt;Note or Footnotes&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"references"</span>, <span class="st">"&lt;References:&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_left"</span>, <span class="st">"Program: &lt;PROGRAM NAME&gt;, YYYY-MM-DD at HH:MM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_right"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Page "</span>, <span class="va">iter</span>, <span class="st">" of "</span>, <span class="va">number_of_pages</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"watermark"</span>, <span class="st">"DRAFT"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi_page_examples_files/figure-html/unnamed-chunk-15-1.png" width="691.2"></p>
</div>
<div class="section level4">
<h4 id="export-to-pdf-jpg-and-png">Export To PDF, JPG and PNG<a class="anchor" aria-label="anchor" href="#export-to-pdf-jpg-and-png"></a>
</h4>
<p><code>gridify</code> supports three file types in
<code><a href="../reference/export_to.html">export_to()</a></code>: PDF, JPG, and PNG.</p>
<p>Using the result from the previous example, the first argument of
<code><a href="../reference/export_to.html">export_to()</a></code> is either your <code>gridify</code> object or a
list of them, and the second is either the desired file path (including
file name) or a vector of them.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"tables"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"tables"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level5">
<h5 id="multi-page-outputs-">Multi-page outputs.<a class="anchor" aria-label="anchor" href="#multi-page-outputs-"></a>
</h5>
<p>For multi-page outputs, PDFs are the most convenient to use. As
mentioned earlier, Rmd and Qmd documents are alternatives for saving
<code>gridify</code> objects, which can be saved directly into your
<code>.Rmd</code> and <code>.Qmd</code> documents.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"./tables/multipageA4.pdf"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"./tables/multipageA4portrait.pdf"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">8.3</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">11.7</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To export as a PNG or JPG, you have two options:</p>
</div>
<div class="section level5">
<h5 id="export-a-single-image">1. Export a single image<a class="anchor" aria-label="anchor" href="#export-a-single-image"></a>
</h5>
<p>This is done by providing a single name for <code>to</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"./tables/singlepage.png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2400</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  to <span class="op">=</span> <span class="st">"./tables/singlepage.jpg"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2400</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="export-multiple-images">2. Export multiple images<a class="anchor" aria-label="anchor" href="#export-multiple-images"></a>
</h5>
<p>This is done by providing a list of names for <code>to</code>. The
lengths of the names vector and the <code>gridify</code> input must be
the same.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"./tables"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"singlepage%s.png"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2400</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"./tables"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"singlepage%s.jpg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2400</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/export_to.html">export_to</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"./tables"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"singlepage%s.pdf"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2400</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="extending-the-multi-page-example">Extending The Multi-Page Example<a class="anchor" aria-label="anchor" href="#extending-the-multi-page-example"></a>
</h4>
<p>In pharmaceutical and other industries, presenting tables often
requires customization to meet reporting standards. While splitting by
rows is a common approach for handling large datasets, it is not the
only option. Here are some potential ways in which a table could be
split up, where <code>gridify</code> could then be used to generate a
new page for each table:</p>
<ul>
<li>
<strong>Group by columns:</strong> Create separate tables for each
unique combination of selected columns, such as treatment groups,
geographic regions, or product categories.</li>
<li>
<strong>Split by columns:</strong> When dealing with wide datasets,
distribute columns across multiple tables to improve readability, such
as separating different performance metrics or variable types.</li>
<li>
<strong>Retain a key column:</strong> Ensure essential identifiers
(e.g., PatientID or TransactionID) appear on every page for easy
reference and consistency.</li>
</ul>
<p>These methods provide greater flexibility in structuring tables,
making them easier to interpret and align with diverse reporting needs
across industries.</p>
</div>
<div class="section level4">
<h4 id="long-table-in-html">Long Table in HTML<a class="anchor" aria-label="anchor" href="#long-table-in-html"></a>
</h4>
<p>When rendering a .Rmd or .Qmd document into HTML, using ‘fixed’ scale
measurements for heights is essential to prevent excessive scrolling or
content being cut off. Additionally, layout margins should be defined in
absolute units, such as inches, cm or mm.</p>
<p>When trying to find the perfect <code>fig.width</code> and
<code>fig.height</code> for the output, instead of guessing, you can use
a binary search method to quickly find the ideal height. Here is an
example:</p>
<ol style="list-style-type: decimal">
<li>Start with a range (e.g., 20 to 120 inches).</li>
<li>Test the midpoint: Try 70 inches (the average of 20 and 120).</li>
<li>Adjust based on results:</li>
<li>If 70 inches is too tall, reduce the value to 45 inches (average of
20 and 70); if too short, increase it to 95 inches (average of 70 and
120).</li>
<li>Repeat the process</li>
</ol>
<p>Keep refining and you will quickly find the optimal height.</p>
<p>The R code below has <code>fig.width = 8</code> and
<code>fig.height = 45</code>. Note that
<code>pharma_layout_letter</code> is using the default heights (similar
to <code>"fixed"</code> scales) and margins in
<code>"inches"</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gt_obj</span> <span class="op">&lt;-</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">Theoph</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridify.html">gridify</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">gt_obj</span>,</span>
<span>  layout <span class="op">=</span> <span class="fu"><a href="../reference/pharma_layout_letter.html">pharma_layout_letter</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_1"</span>, <span class="st">"My Company"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_2"</span>, <span class="st">"&lt;PROJECT&gt; / &lt;INDICATION&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_left_3"</span>, <span class="st">"&lt;STUDY&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"header_right_2"</span>, <span class="st">"&lt;Draft or Final&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"output_num"</span>, <span class="st">"&lt;Table&gt; xx.xx.xx"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_1"</span>, <span class="st">"&lt;Title 1&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"title_2"</span>, <span class="st">"&lt;Title 2&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"note"</span>, <span class="st">"&lt;Note or Footnotes&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"references"</span>, <span class="st">"&lt;References:&gt;"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_left"</span>, <span class="st">"Program: &lt;PROGRAM NAME&gt;, YYYY-MM-DD at HH:MM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_cell.html">set_cell</a></span><span class="op">(</span><span class="st">"footer_right"</span>, <span class="st">"Page xx of nn"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi_page_examples_files/figure-html/unnamed-chunk-20-1.png" width="691.2"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maciej Nasinski, Alexandra Wall, Sarah Robson, Pritish Dash, Jennifer Winick-Ng, UCB S.A., Belgium.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
